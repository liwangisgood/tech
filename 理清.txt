jdbc.url=jdbc:mysql://10.243.82.104:3306/mimsdb_001?characterEncoding=utf-8
jdbc.username=fabu
jdbc.password=6v28XpAVJf7g


jdbc.url1=jdbc:mysql://10.243.82.103:3306/mimsdb_002?characterEncoding=utf-8
jdbc.username1=fabu
jdbc.password1=P3hRJa0j3Z7y

jdbc.url2=jdbc:mysql://10.243.82.102:3306/mimsdb_003?characterEncoding=utf-8
jdbc.username2=fabu
jdbc.password2=t8IT9Pqyu6F0



mims_git 商家库存管理系统
mimm-web 打成jar controller模块层次
mims-intf 服务接口层 service接口、dao接口层次
mims-service 服务实现层 service dao接口实现层
mims-pom 父依赖管理
mims-util apache commons、 BaseController 请求、响应、分页、用户信息
	统一的参数获取Map(key-value)与处理，数据传给视图页面展示，可避免建立很多实体类，接受参数实体类DTO、VO）
	(以前实习，写代码时，都是以数据库表为基础，前端页面->实体类->controller->service->dao->表)
mims-pom 父依赖模块 设置环境变量

web.xml
	过滤器设置编码、授权
	监听器<listener>
	<load-on-startup>

待搞懂
	分库分片：ShardingDalClient

分库规则：根据StatementId从configuration对象读取出对应的分库配置，sqlId和Configuration获取片库规则 分库路由
	FreeMarker语法
	?exists 、  :allocateOrderId(参数占位符)、   ${minRow},${maxRow}

		 <#if supplierCode?exists && supplierCode != ''>
			 	AND SUPPLIER_CODE =:supplierCode
		<#else>

http://mimmsit.cnsuning.com/mimm/inventoryBack/queryActivityCommodity.action

2023/11/3
mims-service模块
spring容器配置、sqlMap、shard配置
看配置了解注入：
	spring容器注入配置文件也区分开(spring-impl.xml (spring-jms.xml (spring-res.xml (spring-rsf.xml)
	分片分库配置文件 (main-shard.xml主库001、swl-shard.xml从库002 003)
spring 配置文件注入成员变量数据，也考虑父类成员变量注入 ，如类ShardingDalClient extends DefaultDalClient
	ref="shardRegister" 注入对象 、值、  配置文件信息value="classpath*:conf/sharding/*.xml" Resource[]
Configuration configuration如何被注入装载数据的？然后从其中查分库配置

类分库客户端ShardingDalClient  属性 shardRegister数据源管理器
类多数据源事务MultiDataSourceTransactionManager transactionManager 属性 shardRegister (方法的事务另外配置传播行为、隔离级别MySql默认可重复读)、aop事务管理作用于mims.intf service接口、mims.impl Service接口实现）
类分库数据源管理器DefaultShardRegister shardRegister 属性 Set<Shard> shards、(注入属性Set集合第一次见)
类分片Shard 属性id、dataSource（类分片中注入了数据源）shard-main
类DriverManagerDataSource 或其继承的属性 url、username、password、Class.forName(driverClassName)
类 
每个分片set注入一个数据源

CookieLocaleResolver Spring Cookie保存国际化语言区域信息，功能注入 想用就插入

mimm-web模块
RemoteTemplateClient、FreeMarkerConfigurationFactoryBean

// 写的不理解 new Configuration(); 
ShardRouter shardRouter = ShardingConfigurationUtil.getStatementMappedShardRouter(configuration, sqlId);

    public static String getStatementMappedShardRef(Configuration configuration, String statementId) {
        @SuppressWarnings("unchecked")
        Map<String, String> sqlShardMapping = (Map<String, String>) configuration
                .getAttribute(SQLRMAPPING_HOLD_ON_CONFIGURATION_ATTRIBUTE_NAME);
        if (sqlShardMapping == null) {
            sqlShardMapping = new HashMap<String, String>();
            configuration.addAttribute(SQLRMAPPING_HOLD_ON_CONFIGURATION_ATTRIBUTE_NAME, sqlShardMapping);
        }
        return sqlShardMapping.get(statementId);// 我的想法是肯定为null 这段代码

    }

频繁创建HashMap<String,Object>分别以_shard_Router_、_sql_Shard_Mapping_、_namespace_Shard_Mapping_为key？


类ShardingDalClient 分库客户端

类Configuration 属性 ConcurrentHashMap<String, MappedStatement> mappedStatements
类MappedSqlExecutor   代码传递数据不理解
            //根据sqlId获取对应的sql描述
            MappedStatement mappedStatement = configuration.getMappedStatement(sqlId, true);
            					    mappedStatements.get(sqlId);

类ShardingDalClient  
	// 代码获取MappedStatement信息
	MappedStatement mappedStatement = configuration.getMappedStatement(sqlId, true);


2023/11/6
freemark的视图解析ViewResovler
写controller->service->dao->ftl文件

    @RequestMapping("/queryActivityCommodity.action")
    public String queryActivityCommodity(HttpServletRequest request){
        Map<String,Object> paramMap = baseController.getParams();
        Page<?> pageInfo = null;
        try{
            pageInfo = inventoryBasicService.queryFactoryActivityCommodity(paramMap);
        }catch (Exception e) {
            LOGGER.error("查询厂送活动商品:" + MsgHandleUtil.getExceptionString(e));
        }
        request.setAttribute("pageInfo", pageInfo);
        return "inventory/activityCommodity";
    }

有些链接访问不了的如：
	http://mimmsit.cnsuning.com/mimm/cswarehouse/queryAddressPage.action 返回对应的ftl文件视图


查询town的数量
	select count(id)
	from mims_t_town
	where 1 = 1
            <#if town_code?? && town_code != ''>
                AND town_code = :town_code
            </#if>
            <#if town_name?? && town_name!= ''>
                AND town_name = :town_name
            </#if>
            <#if district_code?? && district_code!= ''>
                AND district_code = :district_code
            </#if>

    <sql id="PageList">
        <![CDATA[
            select
                id as "id",
                town_code as "town_code",
                town_name as "town_name",
                district_code as "district_code",
                version_no  as "version_no",
                create_time as "create_time",
                update_time as "updateTime",
            from   mims_t_town
            where 1 = 1
            <#if town_code?? && town_code != ''>
                AND town_code = :town_code
            </#if>
            <#if town_name?? && town_name!= ''>
                AND town_name = :town_name
            </#if>
            <#if district_code?? && district_code!= ''>
                AND district_code = :district_code
            </#if>
            LIMIT ${minRow},${maxRow}
        ]]>
    </sql>



占位符   :operator
?? 检查变量是否存在 true或者false
模糊查询不会
?has_content
townInfo.townCode!''


create table mims_t_town
(
  id            bigint auto_increment
  comment '主键ID'
    primary key,
  town_code     varchar(20)  null
  comment '街道编码',
  town_name     varchar(100) null
  comment '街道名称',
  district_code varchar(20)  null
  comment '区编码',
  version_no    varchar(20)  null
  comment '版本号',
  create_time   datetime     null
  comment '创建时间',
  update_time   datetime     null
  comment '最后更新时间'
)
  comment '街道基础表'
  charset = utf8;

create index idx_district_code
  on mims_t_town (district_code);

create index idx_town_code
  on mims_t_town (town_code);

多仓库存
http://mimmsit.cnsuning.com/mimm/commodity/inventory/queryWarehouseCommodity.action

厂送商品活动维护
http://mimmsit.cnsuning.com/mimm/inventoryBack/queryActivityCommodityLog.action

多仓商户优先级
http://mimmsit.cnsuning.com/mimm/multwarehouse/jumpMultiWareHouseProPage.action
jumpMultiWareHouseProPage


http://mimmsit.cnsuning.com/mimm/townDy/queryTownDyInfo.action

queryTownDyInfo.action
deleteOneTownDyInfo.action

街道基础表
街道编码 townCode
街道名称 
分区编码

townInfo.townCode!''}
townInfo.townName!''}
townInfo.districtCode!''
townInfo.versionNo!''
townInfo.createTime!''
townInfo.updateTime!''


create table mims_t_town_dy
(
  id            bigint auto_increment
  comment '主键ID'
    primary key,
  town_code     varchar(20)  null
  comment '街道编码',
  town_name     varchar(200) null
  comment '街道名称',
  district_code varchar(20)  null
  comment '区编码',
  create_time   datetime     null
  comment '创建时间',
  update_time   datetime     null
  comment '更新时间'
)
                            <td>${townInfo.townCode!''}</td>
                            <td>${townInfo.townName!''}</td>
                            <td>${townInfo.districtCode!''}</td>
                            <td>${townInfo.createTime!''}</td>
                            <td>${townInfo.updateTime!''}</td>


http://lw.cnsuning.com/mimm/townDy/queryTownDyInfo.action


解决异常：
jdbc.BadSqlGrammarException: PreparedStatementCallback; bad SQL grammar [select            id as "id",            town_code as "townCode",            town_name as "townName",            district_code as "districtCode",            create_time as "createTime", 

  where 1 = 1 sql拼接的问题

like模糊查询
2023-11-08 20:03:48.443 [http-nio-80-exec-10] DEBUG c.s.f.d.c.s.e.MappedSqlExecutor -Executing prepared SQL statement [select count(id)             from mims_t_town_dy             where 1 = 1                                                       AND town_name = like concat('%',?)                                  ]


yesClose
jQuery弹窗

删除数据不用主键删除，用普通显示在页面上的多个字段作为条件删除

-- auto-generated definition
create table mims_t_town_dy
(
  id            bigint auto_increment
  comment '主键ID'
    primary key,
  town_code     varchar(20)  null
  comment '街道编码',
  town_name     varchar(200) null
  comment '街道名称',
  district_code varchar(20)  null
  comment '区编码',
  create_time   datetime     null
  comment '创建时间',
  update_time   datetime     null
  comment '更新时间'
)
  comment '街道基础表'
  charset = utf8;

create index idx_district_code
  on mims_t_town_dy (district_code);

create index idx_town_code
  on mims_t_town_dy (town_code);

哥 这边mims_t_town_dy表town_code重复挺多的 我本想按照town_code这个字段进行删除、更新

前端无法传递townCode?
<td name="townCode">${townInfo.townCode!''}</td>            
var townCode = $(this).parents('tr').find("td[name='townCode']").html();

http://mimmsit.cnsuning.com/mimm/inventoryBack/queryActivityCommodity.action

我的抖音town问题：
操作人字段缺少

HSSFWorkbook

apache工具类
package org.apache.commons.collections;


2023/11/15
上午
datagrip软件设置正常使用
学习养老二期移动端业务逻辑待测试检验系统
mybtisplus一些方法 注解学习查看


下午
http://d.svndoc.cnsuning.com/svn/zyyl/0养老二期移动端/1.4系统测试 

cookie优缺点
authorization

nginx优缺点

Connection: keep-alive 
	组件缓存 避免组件内数据成



redis
redis持久化 aof rdb
布隆过滤器
  优点：
  1、空间和时间巨大优势(存储和插入时间都是常数)，无需像map set存储元素本身，
  2、散列函数相互见没关系，并行执行。
  缺点：
  1、含有错误率 插入元素越多误错率越大
  2、无法从过滤器删除数据

key的结构
  层级格式 项目名：业务名：类型：id
'{"name": "John","age": 30,"city": "New York","isStudent": false,"grades": [95, 88, 72],"address": {"street": "123 Main St","zipCode":"10001"},"isActive": null}'

'{"name": "John","age": 30,"city": "New York"}'
 缺点：json修改数据，只能重新覆盖，不能针对某一字段修改
string
  set get mset mget decr decrby incr incrby setnx setbit setex
hash
  hset hget hmset hmget hgetall hkeys hvals hincrby hsetnx
  heima:user:1 field value
                      name Jack
                      age    21
允许对单个字段修改
 hset hiema


sso.admin.auth-status-url=http://lwmimmpre.cnsuning.com/authStatus

sso.auth-status-url=https://lwmimspre.cnsuning.com/mims/authStatus
#######
sso.admin.auth-status-url=http://lwscpmsit.cnsuning.com/scpm/authStatus

sso.auth-status-url=https://lwscpcsit.cnsuning.com/scpc/authStatus


月度总结报告

  重点工作：
  内容及目标：
1、完成开发环境的搭建
2、熟悉开发框架及开发语言（java、mysql、vue等）
3、根据现有的开发规范编写demo

  日常工作：
  内容及目标
1、学习现有项目代码及文档
2、熟悉相应业务流程



熟悉了 mims（商家库存管理系统），在此系统编写了demo 
SCPC（ 供应链协同系统），熟悉1219版本的需求，正在进行相关开发 
1、



分配了小功能页面，写了一些功能代码与bug，但最终也已解决。提高了问题解决能力与自我思考，多尝试独立自己解决问题，不懂的再去请教。让我回到了本专业的内容上不至于生疏。两个周日到建邺门店轮岗，在南京这边也感受到了终端的幸苦与不容易，零售行业面临很多挑战，在如今互联网便捷的现实。建邺苏宁宜家，在线下实体中，在闹市，生活餐饮区人流量大地方，家电布展还是很吸引力的。


总部轮岗在供应链部门
重点工作 内容及目标：
(1)、完成开发环境的搭建
(2)、熟悉开发框架及开发语言（java、mysql、vue等）
(3)、根据现有的开发规范编写demo
日常工作 内容及目标:
(1)、学习现有项目代码及文档
(2)、熟悉相应业务流程
部门所做工作：

(1)熟悉供应链内部项目mims（商家库存管理系统），框架后端Spring、MySql等、前端FreeMarker,并在此基础上写了抖音街道demo， 增、删、改、查、导入、导出接口与前端页面顺利编写完成与通过自测，现已发布；

(2)部门需求着手测试，将BUG反馈给开发，协调开发求助产品解决，提高整体进度；

(3)熟悉内部供应链内部项目SCPC（ 供应链采购协同系统），框架Spring、MySql等、前端FreeMarker,熟悉1219版本的需求，开发完成物流下发退厂产能的后端接口功能；

(4)周日在建邺苏宁宜家门店轮岗学习产品知识，接待顾客购买家电，了解门店业务工作；
(5)周一~周五晚上接受体系内课程培养与集团课程培养，提高了专业技术能力认知与业务知识。


http://scpcsit.cnsuning.com/scpc/returnCollaborationBook/toAppointmentPage.action
14042999@cnsuning.com
abc12345


C:\Windows\System32\drivers\etc
127.0.0.1 lwmimmpre.cnsuning.com
127.0.0.1 lwmimspre.cnsuning.com
127.0.0.1 lwscpmsit.cnsuning.com
127.0.0.1 lwscpcsit.cnsuning.com

SCPC供应采销协同系统
商家端scpc_web
http://lwscpcsit.cnsuning.com/scpc/newPurchaseOrder/appointOrderDetail.action?orderId=SCPC2017080800000001
“已入库数量”=该预约单+采购单+行号为主键的对应已入库数量
“预约状态”状态=预约单+采购单+行号对应的状态
“剩余可入库数量”=当预约状态为预约成功、取消预约中、过期取消中时，预约入库数量-已入库数量；当预约状态为已取消、已过期时默认为0
# 查询预约单头信息 order_id 预约单号',
scpc_t_purchase_storage

# 查询预约单商品信息 order_id 预约单号',
scpc_t_purchase_storage_commodity  
scpc_t_purchase_order_detail(采购订单明细表)
	查b.external_ean_code as "eanCode",
      b.unit as "unit"
	关联条件：
	  order_code            varchar(20)                   null comment '订单号',
      item_no               varchar(10)                   null comment '订单行号',

supplierCode 10000197 mod 16 = 5 

253994000 

orderId SCPC2017080800000001 
难点：梳理各个表之间

http://scpcsit.cnsuning.com/scpc/newPurchaseOrder/newPurchaseToDeliverList.action


1、物流下发退厂产能 2、重发功能，对表scpc_t_return_task行字段设置状态status 0 1 2,定时任务后台会去查询调度重发。

物流下发退厂产能信息：退货信息维护在物流系统 现在要转到SCPC（ 供应链采购协同系统）进行管理和使用，接收信息区分退厂产能信息(良品退仓、不良品退仓、退仓标识、不良品返厂维修)，保存到SCPC数据库中(根据标识需求) 

